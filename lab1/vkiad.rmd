---
output:
  word_document: default
  html_document:
    df_print: paged
---
# Лабораторный практикум ВКИАД c R

**Преподаватель**
```
Дорошко Ольга Валерьевна
```
**Студент**
```
Лозюк Илья Дмитриевич, 2 курс, 7 группа, ПМ
```
**Вариант № 2**


# Задание 1. Управление данными в R

Загрузка данных из текстового файла в переменную - таблицу данных

```{r}

qc=read.table("QC2.txt")
```

Размерность таблицы данных
```{r}
dim(qc)
```

Первые три записи из таблицы
```{r}
head(qc, 3)
```

Таблица после переименования переменных
```{r}
names(qc) = c("c1", "kit", "nbug", "maker", "vendor", "c2", "c3", "c4", "bug")
head(qc, 3)
```

Комплексная статистика по переменной vendor   
```{r}
summary(qc$vendor)
```

Комплексная статистика по переменной vendor после ее преобразования в переменную-фактор   
```{r}
summary(as.factor(qc[,"vendor"]))
```

Число изделий, у которых число некритических дефектов (nbug) больше 3
```{r}
sum(qc$nbug > 3)
```

Наблюдения, для которых количество некритических дефектов равно максимальному 
```{r}
qc[max(qc[,"nbug"]) == qc[,"nbug"],]
```

# Задание 2. Описательная статистика и графический анализ

Присоединение таблицы данных к списку текущих переменных и загрузка дополнительной библиотеки   
```{r}
attach(qc)
library("e1071")
```

Выборочные среднее и медиана для переменной с1 в указанном порядке  
```{r}
mean(c1)
median(c1)
```

Выборочные квартили Q1,Q2,Q3 , а также интерквартильный размах для переменной c1  
```{r}
quantile(c1, seq(0.25, 0.75, 0.25))
IQR(c1)
```

Комплексная статистика по переменной c1
```{r}
summary(c1)
```

Дисперсия для переменной с1 и переменной, которая представляет собой линейную комбинацию первой 
```{r}
var(c1)
var(c1 * 2 + 100)
```
**Вывод:** вторая дисперсия больше в `r var(c1 * 2 + 100) / var(c1)` раза.

Дисперсия для переменно с1, вычесленная с использованием векторного выражения
```{r}
sum((mean(c1)-c1)^2/(length(c1) - 1))
```

Гистограмма для переменной с1   
```{r}
hist(c1)
```
**Вывод:** распределение переменной c1 скошено влево, если сравнивать с нормальным распределением.

Асимметрия и эксцесс переменной c1 в указанном порядке  
```{r}
skewness(c1)
kurtosis(c1)
```
**Вывод:**  распределение переменной c1 скошено влево и график более пологий, чем график нормального распределения.

Проверка распределения переменной c1 на нормальность с помощью статистического теста Лиллиефорса
```{r}
library(nortest)
lillie.test(c1)
```
**Вывод:** гипотеза о нормальном распределении не отклоняется на уровне значимости 0.05.

# Задание 3. Анализ статистических зависимостей

Перекодировка переменной kit в переменную с двумя значениями (1 и 2)
```{r}
kit = ifelse(kit < 3, 1, 2)
```

Ранговый коэффициент корреляции Спирмена для переменных kit и maker
```{r}
cor(kit, maker, method="spearman")
```

Таблица сопряженности для переменных kit и maker  
```{r}
table(kit, maker)
```
**Вывод:** согласно ранговому коэффициенту корреляции и таблице сопряженности согласованность между переменными практически отсутствует.

Тест на равенство нулю коэффициента корреляции для переменных с1,с3   
```{r}
cor.test(c1, c3)
```
**Вывод:** гипотеза о равенстве нулю коэффициента корреляции между переменными отклоняется на уровне значимости 0.05.

Корреляционная матрица для числовых характеристик с1-c4  
```{r}
cor(qc[,c("c1", "c2", "c3", "c4")])
```

Матрица корреляции в удобном представлении   
```{r}
symnum(cor(qc[,c("c1", "c2", "c3", "c4")]))
```
**Вывод:** наибольший коэффициент корреляции между переменными c1 и с3.

Построение регрессионной модели по переменным c1 (зависимая - отклик) и с3 (независимая - фактор) и вывод общей статистики по результатам оценивания. 
```{r}
linmod = lm(c1 ~ c3)
summary(linmod)
```
**Вывод:** значим (на уровне 0.05) только коэффициент при независимой переменной c3. Статистика R-квадрат принимает значение 0.8182.

Диаграмма рассеяния с линией регрессии для переменных c1 и c2 
```{r}
plot(c3, c1)
abline(linmod)
```

Коэффициенты модели  
```{r}
coefficients(linmod)
```

График “Квантиль-квантиль” для остатков модели
```{r}
res = residuals(linmod)
qqnorm(res)

```
**Вывод:** большинство точек располагаются вблизи прямой линии, поэтому распределение остатков близко к нормальному.

Тест Колмогорова-Смирнова на нормальность остатков 
```{r}
ks.test(res, pnorm, mean(res), sd(res))
```
**Вывод:** критерий не отклоняет гипотезу о нормальном распределении на уровне значимости 0.05.

# Задание 4. Анализ неоднородных данных

Частоты значений для переменной maker 
```{r}
table(maker)
```

Двухвыборочный t-критерий по переменной c2 c разбиением на подвыборки по переменной maker
```{r}
t.test(c2 ~ maker)
```
**Вывод:** гипотеза о равенстве средних в двух подвыборках отклоняется на уровне значимости 0.05 для переменной c2(средние значения характеристики c2 у двух производителей статистически различимы).

“Ящики с усами” для переменной с2 в разрезе по номеру производителя (maker) 
```{r}
boxplot(c2 ~ maker)
```

График ядерной оценки плотности распределения для переменной c2 
```{r}
plot(density(c2))
```
**Вывод:** из графика видно, что выборка описывается моделью, которая представляет собой смесь двух распределений.

# Задание 5. Классификация неоднородных данных

Диаграмма рассеяния переменных с2 и с4, для которых коэффициент корреляции принимает наиболее близкое к нулю значение 
```{r}
plot(c2, c4)
```

Первые строки матрицы из переменных c2 и с4
```{r}
bind1 = cbind(c2, c4)
head(bind1, 3)
```

Применение кластерного анализа и вывод частот наблюдений в каждом оцененном классе
```{r}
kmres = kmeans(bind1, 2)
table(kmres$cluster)
```

График с классовой принадлежностью наблюдений
```{r}
plot(bind1, pch=kmres$cluster)
legend("topleft", legend = c(1, 2), pch = c(1, 2))
```

Работа с данными закончена
```{r}
detach(qc)
```
